<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Studyfy · Acceso con USB</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            "studyfy-green": "#58cc02",
          },
        },
      },
    };
  </script>
</head>
<body class="min-h-screen bg-gradient-to-br from-studyfy-green via-emerald-500 to-emerald-700 flex items-center justify-center px-4">
  <div class="w-full max-w-md">
    <div class="bg-white/95 backdrop-blur-xl rounded-3xl shadow-2xl px-8 py-10">
      <div class="text-center space-y-6 text-gray-900">
        <h1 class="text-2xl font-semibold tracking-tight">
          Acceso con llave USB
        </h1>

        <p class="text-sm text-gray-600">
          Introduce el código generado por tu llave USB y valida el acceso.
        </p>

        <div class="mt-4 space-y-3 text-left">
          <label for="codeInput" class="block text-xs font-semibold text-gray-500 uppercase tracking-wide">
            Código de autenticación
          </label>
          <input
            id="codeInput"
            type="text"
            inputmode="numeric"
            maxlength="6"
            class="w-full rounded-xl border border-gray-200 px-3 py-2 text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500 font-mono tracking-[0.25em] text-center"
            placeholder="······"
          />
        </div>

        <div class="mt-4">
          <button
            id="validateButton"
            class="w-full bg-sky-500 text-white rounded-xl py-3 text-sm font-medium shadow-md hover:shadow-lg hover:bg-sky-400 active:scale-95 transition-all duration-200"
          >
            Validar código
          </button>
        </div>

        <p id="status" class="text-xs text-gray-500 min-h-[1.5rem] mt-3">
          Esperando código…
        </p>
      </div>
    </div>
  </div>

  <script>
    // Lista de códigos válidos (misma lista que en LLAVE.html)
    const VALID_CODES = [
      "482901","139284","750129","618472","294085","850216","701593","924718","130576","587204",
      "319682","406215","975318","562407","813569","457920","690138","274961","805713","992540",
      "145892","726403","583719","901672","248053","764902","519680","837241","693754","120598",
      "456780","378214","982410","640159","713805","592143","104589","867201","743982","219675",
      "508437","395720","681349","927150","312864","870591","759364","236490","681207","540732",
      "894160","718206","205943","369184","154820","490673","803415","972640","618593","237406",
      "584910","760328","941275","832619","120476","653709","749520","815306","904732","527690",
      "368205","190647","746381","580296","269143","918520","357864","602791","483920","714065",
      "826490","930578","157420","864917","471205","506319","790482","215603","904687","672541",
      "381760","843259","729160","654871","210598","587463","948120","803276","125964","769048"
    ];

    const codeInput = document.getElementById("codeInput");
    const validateButton = document.getElementById("validateButton");
    const statusEl = document.getElementById("status");

    function normalizeCode(value) {
      // Quitar espacios y caracteres no numéricos
      return value.replace(/\\D/g, "").trim();
    }

    function validateCode() {
      const raw = codeInput.value || "";
      const code = normalizeCode(raw);

      if (code.length !== 6) {
        statusEl.textContent = "Introduce un código de 6 cifras.";
        return;
      }

      if (VALID_CODES.includes(code)) {
        statusEl.textContent = "Código válido. Accediendo al panel…";
        // Marcar sesión como autorizada
        localStorage.setItem("autorizado", "autorizado");
        // Redirigir al dashboard
        window.location.href = "dashboard.html";
      } else {
        statusEl.textContent = "Código no válido. Comprueba el código generado por la llave USB.";
      }
    }

    validateButton.addEventListener("click", validateCode);

    // Permitir validar con Enter
    codeInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        validateCode();
      }
    });
  </script>
</body>
</html>
